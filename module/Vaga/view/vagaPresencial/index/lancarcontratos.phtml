 <?php 
 use Base\Model\Constantes;
    foreach ($this->listaVaga as $l):
        $empresa = $l->getEmpresa();
        $carga = $l->getCarga();
        $bolsa = $l->getBolsa();
        $inicio = $l->getInicio();
        $recisao = $l->getRecisao();
        $idVaga = $l->getidVaga();
        $agente = $l->getAgente();
        $idAluno = $l->getIdalunovaga();
        $aluno = $l->getAluno();
        $cursoVaga = $l->getCursovaga();
    endforeach;
?>
<<<<<<< HEAD
=======
<?php
            foreach ($this->listaVaga as $l){
                $reciao = $l->getRecisao();
                $carga = $l->getCarga();
                $bolsa = $l->getBolsa();
                $empresa = $l->getEmpresa();
                $agente = $l->getAgente();
                $inicio = $l->getInicio();
            }
            foreach ($this->selectAluno as $l){
                $aluno = $l->getNome();
                $telefoneAluno = $l->getTelefone();
            }
    ?>
<html lang="pt-br" ng-app="">
    <meta charset="utf-8">
>>>>>>> origin/master
<script>
 $(document).ready(function(){
       $('.date').datepicker({
    	format: 'yyyy-mm-dd',
    	language: 'pt-BR',
    	todayHighlight: true
    });
    $("#my-form").validate({
        highlight: function(element) {
        $(element.form).find("." + element.id )
            .addClass("has-error")
            .removeClass("has-succes");
        $("em").css("color","red");
        $("."+element.id+"-valid").css("display","none");
        },
        unhighlight: function(element) {
        $(element.form).find("." + element.id)
            .removeClass("has-error")
            .addClass("has-success"); 
        $("."+element.id+"-valid").css({
            display: "inline",
            color: "green"
        });
        },
        errorElement: "em",
        messages: {
        inicioEnc: 'Entre com uma data válida',
        fimEnc: 'Entre com uma data válida',
        documento: 'Por favor selecione o tipo de documento'
        },
        rules:{
        inicioEnc: {
           required: true
        },
        fimEnc: {
           required: true 
        },
        documento:{
            required: true
        }
        }
<<<<<<< HEAD
    });
    $('#fim-recisao-<?= $idVaga?>').datepicker()
            .on('changeDate',function(ev){
                if(ev.date.valueOf() > startDate.valueOf()){
                    alert("Error");
                }
    });
    
    $('[data-toggle="popover"]').popover();
 //Bootstrap Toggle
    $(".operacao1").bootstrapToggle({
        on: '<label>1 - </label> Assinado',
        off: '<label>1 - </label> Em Processo',
        onstyle: 'success',
        offstyle: 'warning',
        size: 'mini',
        width: '125',
        style: 'android'
    });
    $(".operacao2").bootstrapToggle({
        on: '<label>2 - </label> Assinado',
        off: '<label>2 - </label> Em Processo',
        onstyle: 'success',
        offstyle: 'warning',
        size: 'mini',
        width: '125',
        style: 'android'
    });
    $(".operacao3").bootstrapToggle({
        on: '<label>3 - </label> Entregue',
        off: '<label>3 - </label> Não Entregue',
        onstyle: 'success',
        offstyle: 'warning',
        size: 'mini',
        width: '125',
        style: 'android'
    });
    $(".operacao4").bootstrapToggle({
        on: '<label>4 - </label> Entregue',
        off: '<label>4 - </label> pendente',
        onstyle: 'success',
        offstyle: 'warning',
        size: 'mini',
        width: '125',
        style: 'android'
    });
    //jquery Validate
  
 });
 function excluirDocumento(idDocumento){
     var apagar = confirm('Deseja realmente excluir este registro?');
      if (apagar){
	 $(".excluir-"+idDocumento)
            .removeClass("fa-trash")
            .addClass("fa-spinner fa-pulse fa-fw");
    $(".btn").attr("disabled",true);
    $.post(
        '<?= $this->url('deleteDocumentoPresencial', ['action' => 'excluir', 'iddelete' => '']) ?>'+idDocumento+'/',
        'json'
        ).always(function() {
             $("#"+idDocumento).hide('2000');
             $(".btn").attr("disabled",false);
        });			
      }else{
         event.preventDefault();
      }	   
 }
  function salvarDocumento(idDocumento){
    $(".salvar-"+idDocumento)
            .addClass("fa fa-spinner fa-pulse fa-fw");
    $(".btn").attr("disabled",true);
    $.post(
     '<?= $this->url('editarDocumento',['action'=>'salvarDocumento']) ?>',
        {
        idDocumento: function(){
                return idDocumento;
            },
        operacao1: function(){
            var  operacao1 = $("#list-"+idDocumento+" input[name='operacao1']");
                if(operacao1.is(":checked")){
                    return '1';  
                }
                else{
                    return '0';
                }   
          },
        operacao2: function(){
            var  operacao2 = $("#list-"+idDocumento+" input[name='operacao2']");
                if(operacao2.is(":checked")){
                    return '1';  
                }
                else{
                    return '0';
                }    
        },
        operacao3: function(){
            var  operacao3 = $("#list-"+idDocumento+" input[name='operacao3']");
                if(operacao3.is(":checked")){
                    return '1';  
                }
                else{
                    return '0';
                }  
        },
        operacao4: function(){
            var  operacao4 = $("#list-"+idDocumento+" input[name='operacao4']");
                if(operacao4.is(":checked")){
                    return '1';  
                }
                else{
                    return '0';
                }    
        }
    },
    'json'
    ).always(function(){
           var n = $( "#list-"+idDocumento+" input:checked").length;
            switch(n){
                case 1: $(".progress-"+idDocumento).css("width",'25%').html("25%") ;
                break
                     case 2: $(".progress-"+idDocumento).css("width",'50%').html("50%") ;
                     break
                          case 3: $(".progress-"+idDocumento).css("width",'75%').html("75%");
                          break
                               case 4: $(".progress-"+idDocumento).css("width",'100%').html("Processo Finalizado!") ;
                               break
                                    case 0: $(".progress-"+idDocumento).css("width",'10%').html("10%") ;
                                        break
              }
        $(".salvar-"+idDocumento).removeClass("fa fa-spinner fa-pulse fa-fw");
        $(".btn").attr("disabled",false);
      }
    );
 };
 function editarDocumento(idDocumento){
     $(".btn-edit").html("<i class='fa fa-spinner fa-pulse fa-fw'></i>");
     $.post(
        '<?= $this->url('editarDocumento',['action'=>'editarDocumento']) ?>',
        {
            idDocumento: function(){
                return idDocumento;
            },
            inicio: function(){
                return $("#editarInicio-"+idDocumento).val();},
            fim: function(){
                return $("#editarFim-"+idDocumento).val();},
            documento: function(){ 
                return $("#editarTipo-"+idDocumento).val();}
        },
        'json').always(
                  location.reload()
                );
 }
 </script>
    <?= $this->painel(Constantes::temaBootstrap)?>
    <?= $this->painelTitulo($aluno)?>
        <ul class="nav nav-tabs" role="tablist">
           <li role="presentation" class="active"><a>Início</a></li>
          <!-- <li role="presentation"><a href="<?php //$this->url('vagaPresencial/default', ['controller' => 'vagapresencial', 'action' => 'acompanhamento','id'=>$idAluno, 'idVaga'=>$idVaga,'curso'=> $cursoVaga]); ?>">Acompanhamento</a></li>-->
        </ul>
        <div class="navbar pager">
        <?=     '<p><label>Agente de Integração: </label>  '.$agente.'</p>'.
                '<p><label>Empresa: </label>'.$empresa.'</p>'.
                '<p><label>Carga-Horária: </label> '.$carga.' horas &nbsp;&nbsp; <label>Bolsa-Auxílo: </label> R$'.$bolsa.',00 </p>';?>
        </div>
    <?= $this->painel(Constantes::temaBootstrap. ' well-sm')?>
    <?= $this->painelTitulo("Processos");
    if (!empty($this->listaContratos)):
        foreach ($this->listaContratos as $l): 
        echo '<div   id="'.$l->getIddocumento().'">'.
        $this->partialLoop('vagaPresencial/layout/processoPartial',[
                    [
                        'idDocumento'=> $l->getIddocumento(),
                        'operacao1'=>$l->getOperacao1(),
                        'operacao2'=>$l->getOperacao2(),
                        'operacao3'=>$l->getOperacao3(),
                        'operacao4'=>$l->getOperacao4(),
                        'relatorio'=>$l->getRelatorio()
                    ]
                ]).
        '<div class="collapse" id="list-'.$l->getIddocumento().'">'.
        '<div class="pager">'.
            $this->partial('vagaPresencial/layout/painelProcessoPartial').
        '</div>';
            $this->processoForm->prepare();
            echo    $this->form()->openTag($this->processoForm).
            '<div class="pager">'.
                '<div class=" col-sm-3">'.
                    
                    $this->formRow($this->processoForm->get('operacao1')
                        ->setAttribute('checked',$l->getOperacao1())
                        ->setAttribute('class', 'operacao1')
                        ->setUncheckedValue('0')
                        ->setCheckedValue('1')).' </div>'.
                '<div class=" col-sm-3">'.
                    $this->formRow($this->processoForm->get('operacao2')
                        ->setAttribute('checked', $l->getOperacao2())
                        ->setAttribute('class', 'operacao2')
                        ->setUncheckedValue('0')
                        ->setCheckedValue('1')).'</div> '.
                '<div class=" col-sm-3">'.
                     $this->formRow($this->processoForm->get('operacao3')
                        ->setAttribute('checked',$l->getOperacao3())
                        ->setAttribute('class', 'operacao3')
                        ->setUncheckedValue('0')
                        ->setCheckedValue('1')).'</div> '.
                '<div class=" col-sm-3">'.
                    $this->formRow($this->processoForm->get('operacao4')
                        ->setAttribute('checked',$l->getOperacao4())
                        ->setAttribute('class', 'operacao4')
                        ->setUncheckedValue('0')
                        ->setCheckedValue('1')).'</div>'.
                    '</div>'.
                    $this->form()->closeTag();
            ?> 
            <div class="pager well thumbnail ">
               <div class="btn-group-sm">
                    <button class="btn btn-success  " onclick="return salvarDocumento(<?= $l->getIddocumento()?>)"><i class="  fa--save  <?= 'salvar-'.$l->getIddocumento()?>"></i><span ><i class="fa fa-check"></i><br></span></button>
                    <button class="btn btn-danger " onclick="return excluirDocumento(<?= $l->getIddocumento()?>)" ><i class="  fa--trash  <?= 'excluir-'.$l->getIddocumento()?>"></i><span ><i class="fa fa-remove"></i><br></span></button>
                    <button type="button" class="btn btn-primary " data-toggle="modal" data-target="#<?= 'modal-'.$l->getIddocumento()?>">
                        <i class=" fa fa-plus"></i>
                    </button>
                    <button type="button" class="btn btn-primary " data-toggle="modal" data-target="#<?= 'modal-editar-'.$l->getIddocumento()?>">
                        <i class=" fa fa-edit"></i>
                    </button>
               </div>
            </div>
    <?=     $this->partialLoop('vagaPresencial/layout/infoProcessoModalPartial',[
                    ['idDocumento'=> $l->getIddocumento(),
                    'inicio'=>$l->getInicio(),
                    'fim'=>$l->getFim(),
                    'relatorio'=>$l->getRelatorio(),
                    'dataLancamento'=> $l->getdataLancamento()]
                ]).    
            $this->partialLoop('vagaPresencial/layout/editarProcessoModalPartial',[
                    [
                    'editarDocumentoForm' =>$this->editarDocumentoForm,
                    'idDocumento'=> $l->getIddocumento(),
                    'inicio'=>$l->getInicio(),
                    'fim'=>$l->getFim(),
                    'relatorio'=>$l->getRelatorio()]
                ]).
            '</div>'
                    . '</div>';
        endforeach;
    else:
        echo    $this->alertaDanger("Nenhum processo lançado"); 
    endif;
        echo    $this->painelFim();  
                $this->documentoForm->prepare();
        echo    $this->form()->openTag($this->documentoForm);
    ?>
    <div class="well pager col-sm-12">
        <button class="btn btn-success  " type="button" data-toggle="collapse" data-target="#NovoProcesso" aria-expanded="false" aria-controls="NovoProcesso">
            Novo Processo <i class="fa fa-bars "></i>
        </button>
        <div class="collapse" id="NovoProcesso">
            <div class="row "><br/>
                <div class="input-daterange date">
                <div class="  col-sm-3 col-sm-offset-1">
                    <div  class=" inicioEnc" >
                     <i style="display: none" class=" inicioEnc-valid glyphicon glyphicon-ok-circle"></i>
                        <?= $this->formRow($this->documentoForm->get('inicioEnc')
                                ->setAttribute('id', 'inicioEnc')
                                ->setAttribute('required', 'true')
                                ->setAttribute('class', 'form-control date')
                        );?>
                    </div>        
                </div>
                <div class="  col-sm-3">
                    <div class=" fimEnc" >
                    <i  style="display: none" class=" fimEnc-valid glyphicon glyphicon-ok-circle"></i>
                    <?= $this->formRow($this->documentoForm->get('fimEnc')
                            ->setAttribute('id', 'fimEnc')
                            ->setAttribute('required', 'true')
                            ->setAttribute('class', 'form-control date'))
                    ;?>
                    </div>
                </div>
                </div>
                <div class="  col-sm-3 documento">
                    <i  style="display: none" class=" documento-valid glyphicon glyphicon-ok-circle"></i>
                    <label>Documento</label>
                    <?= $this->formRow($this->documentoForm->get('documento')
                            ->setAttribute('class', 'form-control ')
                            ->setAttribute('required', 'true')
                            ->setAttribute('id', 'documento')
                            );?>
                </div><br>
                <div class="col-sm-2 ">
                    <?= $this->formSubmit($this->documentoForm->get('lançar')
                            ->setValue('Lançar')
                            ->setAttribute('class', 'btn  btn-success col-sm-offset-1'));
                    ?>
                </div>
            </div>
        </div>
  </div>
<?= '<div class="well-lg ">'.
              $this->botaoGrande(
                        $this->url(Constantes::rotaPerfilAlunoDefault, ['controller' => Constantes::administrador, 'action' => Constantes::perfilAluno,'id'=>$idAluno]) ,
                        'Painel do <br>aluno',
                        'fa-arrow-left',
                        'primary'
                    ).           
                '</div>'.
$this->painelFim();
=======
        else
                campo.value = data;
    }
   
   
};
 function select(id){
             $.ajax({
                 type: '',
                 url: '',
                 data: '',
                 
             })
 
    
    }
$('#myButton').on('click', function () {
    var $btn = $(this).button('loading')
    // business logic...
    $btn.button('reset')
  });
</script>
<body>
           <div class=" nav row" style=" background-color: #1989f1">
             <h5>
                <span style=" color:white"> &nbsp;&nbsp;<?php echo $aluno?></span>
                
                <span style=" color: #fff194" class=" navbar-right"><?php echo $telefoneAluno; ?>&nbsp;&nbsp;</span>
                <span style="color: white" class=" navbar-right">TELEFONE:&nbsp;&nbsp; </span>
             </h5>
            </div>
    <div>
        <div class="row">
            <div class="" style=" ">
            <div class="caption">
                <ul class="nav  nav-tabs" style=" background-color: #f4f4f4">
                    <li class="  active" role="presentation"><a><label>Documentos</label></a></li> 
                </ul>
            </div>
          </div>
     </div>
    </div>
    <br/>
<br/>
<div class="navbar">
        <h3 class="pager"><?php echo $empresa; ?></h3>
        <p class="pager" style=""><label>Carga-Horária: </label> <?php echo $carga; ?> horas &nbsp;&nbsp; <label>Bolsa-Auxílo: </label> R$ <?php echo $bolsa ?>,00
       </p>
         <div><p class=" pager" style=" color: #bdbdbd; font-size: 12px">
                Vaga lançada por : 
            <?php
            foreach ($this->usuario as $l){
               echo $l->getNome(); 
            }
            ?></p><br/> 
        <form method="post"  >
            <div class=" row ">
             <div class="col-lg-4">
                 <div class=" input-group">
                       <span class="input-group-addon date" id="basic-addon1" style=""><b> <a tabindex="0" role="button" data-toggle="popover"  data-placement="top" data-trigger="focus" title="Início e término do estágio" data-content="caso o aluno saia do estágio, é necessário o preenchimento da data final."><i class=" fa fa-question-circle"></i></a>
                       </b></span>
                       <input disabled="" data-provide="datepicker" type="text" class="form-control" value="<?php echo date_format($inicio, 'd/m/Y');?> ">
                       <span class="input-group-addon date" id="basic-addon1" style=""><b> - </b></span><input  style='color: #cf0000' data-provide="datepicker" placeholder="Fim" value="<?php echo $reciao;?>" type="text" name="recisao" class=" form-control" maxlength="10"  />  
                       <span class=" input-group-btn">
                       <button type="submit" value="Salvar" name="salvar" class="btn btn-default info"><i  class="glyphicon glyphicon-ok"></i></button>
                     </span>
                  </div>
             </div>
           </div>
        </form>
        </div>  
    </div> 
<form class="navbar-default" method="post" id="form-documento" onKeyPress="return noenter()"  >
    <div class="row">
      <div class="">
<?php if ($listaContratos):?>    
        <table class="table" onclick="" >   
            <tr  style=" background-color:  #ffffcc;">  
                <th style=" background-color: #fff194; width: 3px"></th>
                <th style="text-align: center">Inicio</th>
                <th style="text-align: center">Fim</th>
                <th style="text-align: center">Tipo Doc.</th>
                <th style="text-align: center; ">Enc.</th>
                <th style="text-align: center;">Liberado</th>
                <th style="text-align: center;">Entregue</th>
                <th style="text-align: center;">Via</th>
                <th style="text-align: center; width: 60px">Editar</th>
                <th style="text-align: center" >Excluir</th>
            </tr>
       
                <?php foreach ($listaContratos as $f):
                    $idalunoEncaminhamento = $f->getidalunoDocumento() ;
                    $idVagaEncaminhamento = $f->getidvagaDocumento() ;
                    $idDocumento = $f->getidDocumento() ;
                    $inicio = $f->getInicio();
                    $fim = $f->getFim();
                ?> 
            <tr style=" text-align:  center" >
            <td  style=" background-color: #1989f1; text-align: center; width: 3px;"></td>
            <td> <?php echo date_format($inicio, 'd/m/Y'); ?>    </td>
            <td> <?php echo date_format($fim, 'd/m/Y') ; ?></td>
            <td>  <?php echo sprintf($f->getRelatorio()) ;?></td>
            <td style="text-align: center;"><input name="encaminhado"  type="checkbox"<?php echo $f->getOperacao1()?>/></td>
            <td style="text-align: center;"><input  name="liberado" type="checkbox" <?php echo $f->getOperacao2()?>/></td>
            <td style="text-align: center;"><input name="entregue" type="checkbox"  <?php echo $f->getOperacao3()?>/></td>
            <td style="text-align: center;"><input name="via" type="checkbox"  <?php echo $f->getOperacao4()?>/></td>
            <td><a data-toggle="modal" data-target="#editarcontrato" ><i  class="glyphicon glyphicon-edit"></i></a></td>
            <td><a onclick="return confirm('Tem certeza que deseja deletar este lançamento?')" style="color: #c81616" class="btn" href="<?php echo $this->url('deleteDocumentoPresencial', array('action' => 'excluir', 'iddelete' => $f->getIdDocumento(),'curso'=>$f->getcursoDocumento())) ?>"><i class=" glyphicon glyphicon-remove"></i></a></td>      
        </tr>
        
        
                    <?php  endforeach;?> 
    </table>
    
   <?php else:?>
    <div class="alert-danger" style="margin: initial">
           <br/>
           <h4 style="text-align: center">Nenhum documento lançado </h4><br/>      
    </div>
      <?php endif;?>
      </div>
        </div>
            <div style="background:  #bef1ba; border: #38820c" class=" navbar-brand">
                <div class="  col-lg-3">
                    <div  class="input-group date" >
                        <input  class="form-control" type="date" name="inicioEnc"   required="" />
                    <div class="input-group-addon">
                        <span class="glyphicon glyphicon-th"></span>
                    </div>
                    </div>        
                    </div>
                 <div class="  col-lg-3">
                <div class="input-group date " >
                    
                    <input   class=" form-control datepicker"  name="fimEnc" type="date" required="" /><div class="input-group-addon">
                        <span class="glyphicon glyphicon-th"></span>
                    </div>
                    </div>
                 </div>
                <div class="  col-lg-3">
                            <select class="form-control"  name="relatorio" >
                            <option>TCE</option>
                            <option>TA</option>
                            <option>1º RT (Instituição)</option>
                            <option>2° RT (Instituição)</option>
                            <option>3° RT (Instituição)</option>
                            <option>4º RT (Instituição)</option>
                            <option>1° RT (Empresa)</option>
                            <option>2° RT (Empresa)</option>
                            <option>3° RT (Empresa)</option>
                            <option>4º RT (Empresa)</option>
                            </select>
                        </div>
               
                   
                 <div class="">
                     <button  type="submit" name="lançar" class="btn  btn-primary" value="Lançar" id="myButton" data-loading-text="Lançando..." autocomplete="off" >Lançar Documento</button>
            </div>
            </div>
           
</form>
<script> 
    $('.input-group.date').datepicker({
    	format: 'yyyy-mm-dd',
    	language: 'pt-BR',
    	weekStart: 0,
    	startDate:'',
    	todayHighlight: true
    });
$(function () {
  $('[data-toggle="popover"]').popover();
});

</script>
            <div style=" margin-top: 10%"><br/>
            <div class="pager">
                <a href="<?php echo $this->url('perfilPresencial/default',array('controller' => 'alunoPresencial', 'action' => 'perfil','id'=>$idaluno)) ?>"><span class="btn btn-default" > Voltar</span></a>
            </div>
            </div> 
<?php  echo $this->resp; ?>
<script type="text/javascript">
function toogle_disabled( bool )
{
	var input = document.getElementsByTagName('input');
	for( var i=0; i<=(input.length-1); i++ )
	{
		if( input[i].type!='button' ) 
			input[i].disabled = bool;
	}
	
};
$("form#form-documento").submit(
        function(){
        var id = $("#id").val();
        
     $.ajax({
        url: 'vagaPresencial/flag/excluir/'+id+'/',
        type: 'POST',
        data:{ 
            documentoId : $('td[id='+id+']').val()
        }
    }).done();
    }
            );
   
</script>
</body>
</html>
>>>>>>> origin/master
